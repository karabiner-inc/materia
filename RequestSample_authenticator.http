############################################
# APIリクエストサンプル集
#
############################################

@url = http://localhost:4001
#@url = https://

### ユーザー仮登録
POST {{url}}/api/tmp-registration HTTP/1.1
Content-Type: application/json

 {
    "email": "kari3@example.com", 
    "role": "service-user"
  }

### ユーザー登録
POST {{url}}/api/ops/users HTTP/1.1
Content-Type: application/json

 {
    "name": "hogehoge太郎",
    "email": "admin@example.com", 
    "password": "password",
    "role": "admin"
  }

### メール認証

POST {{url}}/api/verify_user HTTP/1.1
Content-Type: application/json

 {
    "verify_key": "hogehoge",
    "email": "admin@example.com", 
    "password": "password"
  }

###ログイン
POST {{url}}/api/sign-in HTTP/1.1
Content-Type: application/json

{
    "email": "hogehoge@example.com", 
    "password": "hogehoge"
  }


###ログイン
POST {{url}}/api/sign-in-with-refresh HTTP/1.1
Content-Type: application/json

{
    "email": "hogehoge@example.com", 
    "password": "hogehoge"
  }

###ログイン
POST {{url}}/api/sign-in HTTP/1.1
Content-Type: application/json

{
    "email": "fugafuga@example.com", 
    "password": "fugafuga"
  }

###ログイン(メールアドレス相違)
POST {{url}}/api/sign-in HTTP/1.1
Content-Type: application/json

{
    "email": "notexists@example.com", 
    "password": "hogehoge"
  }

###ログイン(パスワード相違)
POST {{url}}/api/sign-in HTTP/1.1
Content-Type: application/json

{
    "email": "hogehoge@example.com", 
    "password": "fugafuga"
  }

@token = Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJTZXJ2aWNleCIsImVtYWlsIjoiaG9nZWhvZ2VAZXhhbXBsZS5jb20iLCJleHAiOjE1NDA4MDUwMjcsImlhdCI6MTU0MDgwNDQyNywiaXNzIjoiU2VydmljZXgiLCJqdGkiOiIyMWM4MmNkMy01ZmRjLTRkYzItYjE4MS1kZWY4OTNhZmI4YmEiLCJuYmYiOjE1NDA4MDQ0MjYsInN1YiI6IjEiLCJ0eXAiOiJhY2Nlc3MifQ.H6sMFoAb5FW27MguIdfqEgC6yMBGLeNeehsEjutKulBL0PMlFBIXruPaCa-Nf_9sXI4Cd-KSmsTsQR5yEL7stA

###認証チェック

GET {{url}}/api/auth-check HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

###トークンリフレッシュ

POST {{url}}/api/refresh HTTP/1.1
Content-Type: application/json

{
  "refresh_token": "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJTZXJ2aWNleCIsImVtYWlsIjoiaG9nZWhvZ2VAZXhhbXBsZS5jb20iLCJleHAiOjE1NDA4MDUwMjcsImlhdCI6MTU0MDgwNDQyNywiaXNzIjoiU2VydmljZXgiLCJqdGkiOiIyMWM4MmNkMy01ZmRjLTRkYzItYjE4MS1kZWY4OTNhZmI4YmEiLCJuYmYiOjE1NDA4MDQ0MjYsInN1YiI6IjEiLCJ0eXAiOiJhY2Nlc3MifQ.H6sMFoAb5FW27MguIdfqEgC6yMBGLeNeehsEjutKulBL0PMlFBIXruPaCa-Nf_9sXI4Cd-KSmsTsQR5yEL7stA"
}


###ユーザー情報照会(一般ユーザー用)
GET {{url}}/api/user HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

###ユーザー一覧照会(オペレーター用)
GET {{url}}/api/ops/users HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

###ユーザー情報照会(オペレーター用)
GET {{url}}/api/ops/users/2 HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

###権限情報一覧照会
GET {{url}}/api/ops/grants HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

###権限情報照会
GET {{url}}/api/ops/grants/4 HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

###ロール指定の権限照会
POST {{url}}/api/grant HTTP/1.1
Content-Type: application/json
Authorization: {{token}}

{
  "role": "admin"
}


###ログアウト
POST {{url}}/api/sign-out HTTP/1.1
Content-Type: application/json
Authorization: {{token}}
